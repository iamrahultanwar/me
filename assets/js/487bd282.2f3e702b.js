"use strict";(self.webpackChunkme=self.webpackChunkme||[]).push([[7001],{3905:function(e,t,r){r.d(t,{Zo:function(){return p},kt:function(){return c}});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var d=n.createContext({}),i=function(e){var t=n.useContext(d),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},p=function(e){var t=i(e.components);return n.createElement(d.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,d=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=i(r),c=a,k=u["".concat(d,".").concat(c)]||u[c]||m[c]||o;return r?n.createElement(k,s(s({ref:t},p),{},{components:r})):n.createElement(k,s({ref:t},p))}));function c(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,s=new Array(o);s[0]=u;var l={};for(var d in t)hasOwnProperty.call(t,d)&&(l[d]=t[d]);l.originalType=e,l.mdxType="string"==typeof e?e:a,s[1]=l;for(var i=2;i<o;i++)s[i]=r[i];return n.createElement.apply(null,s)}return n.createElement.apply(null,r)}u.displayName="MDXCreateElement"},8245:function(e,t,r){r.r(t),r.d(t,{assets:function(){return p},contentTitle:function(){return d},default:function(){return c},frontMatter:function(){return l},metadata:function(){return i},toc:function(){return m}});var n=r(7462),a=r(3366),o=(r(7294),r(3905)),s=["components"],l={sidebar_position:1,title:"Routes"},d=void 0,i={unversionedId:"projects/hydyco/framework/hydyco-rotues/routes",id:"projects/hydyco/framework/hydyco-rotues/routes",title:"Routes",description:"Hydyco Routes allow us to override core Routes functionality",source:"@site/docs/projects/hydyco/framework/hydyco-rotues/routes.md",sourceDirName:"projects/hydyco/framework/hydyco-rotues",slug:"/projects/hydyco/framework/hydyco-rotues/routes",permalink:"/docs/projects/hydyco/framework/hydyco-rotues/routes",draft:!1,editUrl:"https://github.com/iamrahultanwar/me/tree/master/docs/projects/hydyco/framework/hydyco-rotues/routes.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"Routes"},sidebar:"mainSidebar",previous:{title:"Custom Plugin",permalink:"/docs/projects/hydyco/framework/hydyco-core/customPlugin"},next:{title:"MongoDB",permalink:"/docs/projects/hydyco/framework/hydyco-db/mongdb"}},p={},m=[{value:"How it works ?",id:"how-it-works-",level:2},{value:"Generating routes manually",id:"generating-routes-manually",level:2},{value:"Main Methods",id:"main-methods",level:2},{value:"list",id:"list",level:3},{value:"create",id:"create",level:3},{value:"read",id:"read",level:3},{value:"update",id:"update",level:3},{value:"delete",id:"delete",level:3},{value:"deleteAll",id:"deleteall",level:3},{value:"Route Helper Methods",id:"route-helper-methods",level:2},{value:"before",id:"before",level:3},{value:"after",id:"after",level:3},{value:"Custom Routes",id:"custom-routes",level:2},{value:"Adding Route Middleware",id:"adding-route-middleware",level:2},{value:"Override complete example",id:"override-complete-example",level:2}],u={toc:m};function c(e){var t=e.components,r=(0,a.Z)(e,s);return(0,o.kt)("wrapper",(0,n.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Hydyco Routes")," allow us to override core Routes functionality"),(0,o.kt)("h2",{id:"how-it-works-"},"How it works ?"),(0,o.kt)("p",null,"Hydyco Routes are set of express routes which provides all the crud operations by default"),(0,o.kt)("p",null,"These routes can be defined from ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/docs/admin/core/collectoins#create-new-schema"},"admin panel")),", which will tell Hydyco to generate allowed routes."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"MongooseExpress")," class is used under the hood to generate routes for ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/docs/framework/hydyco-core/server"},"Hydyco Server"))),(0,o.kt)("h2",{id:"generating-routes-manually"},"Generating routes manually"),(0,o.kt)("p",null,"If you want to register routes manually you can do something like thing\nand pass on to ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/docs/framework/hydyco-core/server#register-routes"},"Hydyco Server Routes"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'const cart = new MongooseExpress("cart");\n\nserver.registerRoutes([cart]);\n')),(0,o.kt)("h2",{id:"main-methods"},"Main Methods"),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Methods can be managed from ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"/docs/admin/core/collectoins#create-new-schema"},"admin panel"))))),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:"left"},"Params"),(0,o.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"request"),(0,o.kt)("td",{parentName:"tr",align:"left"},"express request, includes ",(0,o.kt)("strong",{parentName:"td"},"methodCall"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"response"),(0,o.kt)("td",{parentName:"tr",align:"left"},"express response")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"next"),(0,o.kt)("td",{parentName:"tr",align:"left"},"express next function, to forward the request call")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"MongooseModel"),(0,o.kt)("td",{parentName:"tr",align:"left"},"working mongoose model")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"HelperMongooseModels"),(0,o.kt)("td",{parentName:"tr",align:"left"},"helper mongoose models")))),(0,o.kt)("h3",{id:"list"},"list"),(0,o.kt)("p",null,"List out all the data"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"list(request, response, mongooseModel, [helperMongooseModel]);\n")),(0,o.kt)("h3",{id:"create"},"create"),(0,o.kt)("p",null,"Create data"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"create(request, response, mongooseModel, [helperMongooseModel]);\n")),(0,o.kt)("h3",{id:"read"},"read"),(0,o.kt)("p",null,"Read data"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"read(request, response, mongooseModel, [helperMongooseModel]);\n")),(0,o.kt)("h3",{id:"update"},"update"),(0,o.kt)("p",null,"Update data"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"update(request, response, mongooseModel, [helperMongooseModel]);\n")),(0,o.kt)("h3",{id:"delete"},"delete"),(0,o.kt)("p",null,"Delete data"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"delete (request, response, mongooseModel, [helperMongooseModel]);\n")),(0,o.kt)("h3",{id:"deleteall"},"deleteAll"),(0,o.kt)("p",null,"Delete all data"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"deleteAll(request, response, mongooseModel, [helperMongooseModel]);\n")),(0,o.kt)("p",null,"All methods except same arguments"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// complete example\n async read(req, res, Cart, [CartItem]) {\n    try {\n      const cart = await Cart.findById(req.params.id).lean();\n      const cartItems = await CartItem.find({\n        cart: cart._id,\n        orderPlaced: false,\n      }).lean();\n      cart.items = cartItems;\n      return res.send({ cart });\n    } catch (error) {\n      return res.status(500).send({ status: false, message: error.message });\n    }\n  }\n")),(0,o.kt)("h2",{id:"route-helper-methods"},"Route Helper Methods"),(0,o.kt)("h3",{id:"before"},"before"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"before method")," runs before every request. Before can be treated as pre middleware that will get execute before every request made in ",(0,o.kt)("inlineCode",{parentName:"p"},"HydycoRoutes"),"."),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},(0,o.kt)("inlineCode",{parentName:"p"},"request")," has special attribute ",(0,o.kt)("strong",{parentName:"p"},"methodCall")," - which is basically the current method which will get executed, rest remains the same"))),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:"left"},"Params"),(0,o.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"request"),(0,o.kt)("td",{parentName:"tr",align:"left"},"express request, includes ",(0,o.kt)("strong",{parentName:"td"},"methodCall"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"response"),(0,o.kt)("td",{parentName:"tr",align:"left"},"express response")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"next"),(0,o.kt)("td",{parentName:"tr",align:"left"},"express next function, to forward the request call")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"MongooseModel"),(0,o.kt)("td",{parentName:"tr",align:"left"},"working mongoose model")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"HelperMongooseModels"),(0,o.kt)("td",{parentName:"tr",align:"left"},"helper mongoose models")))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'  async before(req, res, next, MongooseModel,[helperModel]) {\n    if (req.methodCall === "update") {\n      if (req.body.count === 0) {\n        await MongooseModel.findByIdAndDelete(req.params.id);\n        return res.send({ status: true, message: "Item Removed" });\n      }\n      return next();\n    }\n    if (req.methodCall === "create") {\n      req.body.orderPlaced = false;\n      return next();\n    }\n\n    if (req.methodCall === "list") {\n      req.query.filter.orderPlaced = false;\n      return next();\n    }\n\n    next();\n  }\n')),(0,o.kt)("h3",{id:"after"},"after"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"after method")," runs after every request. After can be treated as post middleware that will get executed after every request is completed in ",(0,o.kt)("inlineCode",{parentName:"p"},"HydycoRoutes"),"."),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},(0,o.kt)("inlineCode",{parentName:"p"},"request")," has special attribute ",(0,o.kt)("strong",{parentName:"p"},"methodCall")," - which is basically the current method which will get executed, rest remains the same"))),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:"left"},"Params"),(0,o.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"result"),(0,o.kt)("td",{parentName:"tr",align:"left"},"Result returned by every method")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"request"),(0,o.kt)("td",{parentName:"tr",align:"left"},"express request, includes ",(0,o.kt)("strong",{parentName:"td"},"methodCall"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"response"),(0,o.kt)("td",{parentName:"tr",align:"left"},"express response")))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'  after(result, request, response) {\n    if (request.methodCall === "list") {\n      if (result.length) {\n        result = result[0];\n      } else result = null;\n    }\n\n    return response.send(result);\n  }\n')),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Important")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"after method always expect a ",(0,o.kt)("strong",{parentName:"p"},"return")," statement"))),(0,o.kt)("h2",{id:"custom-routes"},"Custom Routes"),(0,o.kt)("p",null,"You can add custom routes if required"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'const { MongooseExpress } = require("@hydyco/mongoose-plugin");\n\nclass CartRoutes extends MongooseExpress {\n  constructor() {\n    super("cart");\n  }\n\n  customRoutes(router, defaultPath, model, helperModels) {\n    router.get(defaultPath + "/custom", async (request, response) => {\n      const result = await model.find({});\n      return response.send(result);\n    });\n    return router;\n  }\n}\n\nmodule.exports = new CartRoutes();\n')),(0,o.kt)("div",{className:"admonition admonition-danger alert alert--danger"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"Important")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Custom Routes method always expect router as return"))),(0,o.kt)("h2",{id:"adding-route-middleware"},"Adding Route Middleware"),(0,o.kt)("p",null,"You can add middleware specific to methods,"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'const cart = new MongooseExpress("cart");\n\n// single\ncart.addMiddleware("list", (req, res, next) => {\n  next();\n});\n\n// multiple\ncart.addMiddleware("list", [\n  (req, res, next) => {\n    next();\n  },\n]);\n')),(0,o.kt)("h2",{id:"override-complete-example"},"Override complete example"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'const { MongooseExpress, HydycoModel } = require("@hydyco/mongoose-plugin");\n\nconst UserProfile = new HydycoModel("userProfile").mongooseModel();\n\nclass UserRoutes extends MongooseExpress {\n  constructor() {\n    super("user", ["userProfile"]);\n  }\n\n  // before method\n  async before(request, response, next, User, [UserProfile]) {\n    const { methodCall } = request;\n\n    if (methodCall === "create") {\n      if (request.body && request.body.email && request.body.password) {\n        return next();\n      } else {\n        return response.send({ status: false, message: "Data missing" });\n      }\n    } else {\n      return next();\n    }\n  }\n\n  // after method\n  async after(result, request, response) {\n    const { methodCall } = request;\n\n    if (methodCall === "create") {\n      await UserProfile.create({ userId: result._id });\n    }\n\n    return response.send(result);\n  }\n\n  // override default read method\n  read(request, response, User, [UserProfile]) {\n    try {\n      const user = await User.find({});\n      const userProfile = await UserProfile.findOne({ userId: user._id });\n      return response.send({ users, userProfile });\n    } catch (error) {\n      return response.send({ status: false, message: error.message });\n    }\n  }\n}\n\nconst userRoutes = new UserRoutes();\n\n// adding middleware\nuserRoutes.addMiddleware("list", (req, res, next) => {\n  console.log("In list method");\n});\n\nmodule.exports = userRoutes;\n')))}c.isMDXComponent=!0}}]);